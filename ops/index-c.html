<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon"  href="../images/icon.png" type="image/x-icon"/>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>交接小工具</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
</head>
<body>
    <button id="darkModeToggle" class="dark-mode-toggle">
        <span class="toggle-icon">🌞</span>
    </button>
    <button id="languageToggle" class="language-toggle" title="Switch to Chinese">
        <span class="language-icon">🌏</span>
    </button>
    <button id="logoutToggle" class="logout-toggle" title="Logout">
        <span class="logout-icon">🚪</span>
    </button>
    <h1>交接小工具</h1>

    <div class="button-group">
        <button id="addTaskBtn" class="add-task-btn">添加事项</button>
        <button id="backupBtn" class="backup-btn">保存当前事项</button>
        <button id="loadBackupBtn" class="load-backup-btn">导入事项文件</button>
    </div>

    <!-- Kanban Board -->
    <div class="kanban-board">
        <div class="kanban-column" id="new-column" ondrop="drop(event)" ondragover="allowDrop(event)">
            <h2>待处理</h2>
            <ul class="task-list" id="new-tasks"></ul>
        </div>

        <div class="kanban-column" id="pending-column" ondrop="drop(event)" ondragover="allowDrop(event)">
            <h2>处理中</h2>
            <ul class="task-list" id="pending-tasks"></ul>
        </div>

        <div class="kanban-column" id="completed-column" ondrop="drop(event)" ondragover="allowDrop(event)">
            <h2>已完成</h2>
            <ul class="task-list" id="completed-tasks"></ul>
        </div>

        <div class="kanban-column" id="scheduled-column" ondrop="drop(event)" ondragover="allowDrop(event)">
            <h2>排期处理</h2>
            <ul class="task-list" id="scheduled-tasks"></ul>
        </div>
    </div>

    <!-- Task Creation Modal -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>创建事项</h2>
            <div class="input-group">
                <label for="new-task-input">事项标题</label>
                <input type="text" id="new-task-input" placeholder="请输入事项标题...">
            </div>
            <div class="input-group">
                <label for="new-task-content">事项内容</label>
                <textarea id="new-task-content" placeholder="请输入事项内容..." rows="3"></textarea>
            </div>
            <div class="input-group">
                <label for="task-tags">选择项目</label>
                <div class="tag-selector">
                    <div class="tag-option" data-tag="apisys">
                        <span class="tag-color apisys"></span>
                        <span class="tag-name">Apisys</span>
                    </div>
                    <div class="tag-option" data-tag="cash">
                        <span class="tag-color cash"></span>
                        <span class="tag-name">现金 Cash</span>
                    </div>
                    <div class="tag-option" data-tag="credit">
                        <span class="tag-color credit"></span>
                        <span class="tag-name">信用 Credit</span>
                    </div>
                    <div class="tag-option" data-tag="lottery">
                        <span class="tag-color lottery"></span>
                        <span class="tag-name">开奖网</span>
                    </div>
                    <div class="tag-option" data-tag="grafana">
                        <span class="tag-color grafana"></span>
                        <span class="tag-name">Grafana</span>
                    </div>
                    <div class="tag-option" data-tag="other">
                        <span class="tag-color other"></span>
                        <span class="tag-name">其他</span>
                    </div>
                </div>
            </div>
            <div class="input-group">
                <label for="new-task-file">上传文件（如有）</label>
                <div class="file-upload">
                    <input type="file" id="new-task-file">
                    <label for="new-task-file" class="file-label">
                        <span class="file-icon">📎</span>
                        <span class="file-text">选择文件</span>
                    </label>
                </div>
            </div>
            <div class="modal-actions">
                <button class="cancel-btn" onclick="closeModal()">取消</button>
                <button class="create-btn" onclick="addTask('New')">添加事项</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <br>
        <p>交接小工具 | Yialex@2024</p>
    </footer>

    <script src="script.js"></script>
    <script>
        const username = localStorage.getItem('username');

        if (username === null || username === undefined || username !== 'Ops') {
            window.location.href = '../login.html';
        }
    </script>
</body>
</html>